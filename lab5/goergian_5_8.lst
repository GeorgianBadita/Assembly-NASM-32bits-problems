     1                                  ;Badita Marin-Georgian, 211, 31-10-2017, tema lab 5, problema 8
     2                                  
     3                                  ;Se da un numar natural a (a: dword, definit in segmentul de date). Sa se citeasca un numar natural b si sa se calculeze: a + a\b. Sa se ;afiseze rezultatul operatiei. Valorile vor fi afisate in format decimal (baza
     4                                  
     5                                  bits 32
     6                                  
     7                                  
     8                                  global start        
     9                                  
    10                                  
    11                                  extern exit, scanf, printf            
    12                                  import exit msvcrt.dll
    13                                  import scanf msvcrt.dll
    14                                  import printf msvcrt.dll
    15                                  
    16                                  segment data use32 class=data
    17 00000000 0000                        b dw 0
    18 00000002 0C000000                    a dd 12
    19 00000006 00000000                    rez dd 0
    20 0000000A 256400                      format_scan db "%d", 0 ;conventia folosita pentru citire
    21 0000000D 25640A00                    format_printf db "%d", 10, 0 ;conventia folosita pentru afisare
    22                                  
    23                                  ; our code starts here
    24                                  segment code use32 class=code
    25                                      start:
    26                                          
    27 00000000 66A1[02000000]                  mov AX, WORD [a] ;punem in AX partea low din dwordul a
    28 00000006 668B15[04000000]                mov DX, WORD [a + 2] ;punem in DX partea high din dwordul a
    29 0000000D 8B0D[02000000]                  mov ECX, [a] ;copiem valoarea lui a
    30 00000013 60                              PUSHAD ;salvam valoriile registriilor
    31 00000014 68[00000000]                    push DWORD b ;punem b pe stiva
    32 00000019 68[0A000000]                    push DWORD format_scan ;punem formatul pe stiva
    33                                          
    34 0000001E FF15[00000000]                  call [scanf] ;citim b-ul
    35 00000024 83C408                          add esp, 4*2 ;eliberam stiva
    36 00000027 61                              POPAD ;restauram valorile registriilor
    37                                        
    38                                          
    39 00000028 66F73D[00000000]                idiv WORD [b] ;AX = DX:AX / b = a / b
    40 0000002F 98                              cwde ;AX -> EAX
    41                                         
    42 00000030 01C8                            add EAX, ECX ;EAX = a + a/b
    43                                          
    44 00000032 A3[06000000]                    mov [rez], EAX ;rez = a + a/b
    45 00000037 FF35[06000000]                  push DWORD [rez] ;punem rezultatul pe stiva
    46 0000003D 68[0D000000]                    push format_printf ;punem formatul de afisare pe stiva
    47 00000042 FF15[00000000]                  call [printf] ;apelam functia printf
    48                                          
    49 00000048 83C408                          add ESP, 4*2 ;eliberam stiva
    50                                          
    51                                          
    52 0000004B 6A00                            push    dword 0      
    53 0000004D FF15[00000000]                  call    [exit]      
